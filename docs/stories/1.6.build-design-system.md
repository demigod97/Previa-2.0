# Story 1.6: Build Previa Design System

## Status
Draft

## Story
**As a** developer,
**I want** to implement the Previa design system with warm color palette and financial-focused components,
**so that** the application has consistent, accessible, and brand-appropriate styling throughout.

## Acceptance Criteria
1. Previa color palette implemented in Tailwind CSS configuration
2. CSS custom properties defined for semantic color usage
3. Typography system configured with Inter and JetBrains Mono fonts
4. shadcn/ui components customized with Previa theme
5. Financial-specific color coding implemented (success, warning, error states)
6. Component documentation created with examples
7. Accessibility standards met (WCAG AA contrast ratios)
8. Design tokens work across all planned components

## Tasks / Subtasks
- [ ] Update Tailwind configuration with Previa colors (AC: 1)
  - [ ] Remove PolicyAi color references from safelist
  - [ ] Add Previa brand colors to theme extension
  - [ ] Configure custom color palette: cream, stone, sand, charcoal, darkStone
  - [ ] Ensure color values match frontend specification exactly
- [ ] Implement CSS custom properties (AC: 2)
  - [ ] Create globals.css with Previa color variables
  - [ ] Define semantic color mapping (background, primary, secondary, accent)
  - [ ] Add financial status colors (success, warning, error, processing)
  - [ ] Ensure dark mode compatibility (future-proofing)
- [ ] Configure typography system (AC: 3)
  - [ ] Import Inter font family for headings and body text
  - [ ] Import JetBrains Mono for financial numbers and amounts
  - [ ] Configure font scale (h1-h4, body, small) with proper weights
  - [ ] Set up responsive typography scaling
- [ ] Customize shadcn/ui components (AC: 4)
  - [ ] Update Button component with Previa styling
  - [ ] Customize Card component for financial data display
  - [ ] Style Form components with Previa colors
  - [ ] Update Table component for transaction displays
  - [ ] Customize Dialog and Modal components
- [ ] Implement financial-specific styling (AC: 5)
  - [ ] Define transaction status color coding
  - [ ] Create reconciliation confidence indicators
  - [ ] Add currency amount formatting styles
  - [ ] Implement file upload progress indicators
  - [ ] Style gamification badges and rewards
- [ ] Create component documentation (AC: 6)
  - [ ] Document color usage guidelines
  - [ ] Create typography examples
  - [ ] Show component variants and states
  - [ ] Provide code examples for common patterns
  - [ ] Document accessibility features
- [ ] Validate accessibility compliance (AC: 7)
  - [ ] Test contrast ratios for all color combinations
  - [ ] Ensure focus indicators meet visibility requirements
  - [ ] Verify screen reader compatibility
  - [ ] Test keyboard navigation patterns
- [ ] Test design system integration (AC: 8)
  - [ ] Verify colors work in all planned components
  - [ ] Test typography rendering across browsers
  - [ ] Validate responsive behavior
  - [ ] Ensure design tokens compile correctly

## Dev Notes

### Previous Story Insights
Stories 1.1-1.5 established foundation. This story creates the visual identity that will be used throughout Epic 2+ feature development.

### Architecture Context
- **UI Framework:** shadcn/ui with Tailwind CSS for consistent, accessible components [Source: TECHNICAL-DECISIONS.md#9]
- **Design System:** Previa brand identity with warm color palette [Source: frontend-spec-new.md#1]
- **Accessibility:** WCAG AA compliance required for financial application [Source: frontend-spec-new.md#5]

### Previa Color Palette Specification
**Brand Colors:** [Source: frontend-spec-new.md#1.1]
```typescript
previa: {
  cream: '#F2E9D8',      // Primary background, light surfaces
  stone: '#8C877D',      // Secondary text, borders
  sand: '#D9C8B4',       // Accent elements, hover states
  charcoal: '#403B31',   // Primary text, headings
  darkStone: '#595347',  // Secondary headings, icons
}
```

**Semantic Mapping:** [Source: frontend-spec-new.md#1.1]
- Background: cream (#F2E9D8)
- Primary Text: charcoal (#403B31)
- Secondary Text: stone (#8C877D)
- Accent/Interactive: sand (#D9C8B4)
- Emphasis: darkStone (#595347)

**Financial Status Colors:** [Source: frontend-spec-new.md#1.1]
- Success/Approved: Green (#10B981)
- Warning/Matched: Amber (#F59E0B)
- Error/Rejected: Red (#EF4444)
- Processing: Blue (#3B82F6)

### Typography System Requirements
**Font Configuration:** [Source: frontend-spec-new.md#1.2]
- **Headings:** Inter (Bold/Semibold)
- **Body:** Inter (Regular/Medium)
- **Financial Numbers:** JetBrains Mono for clarity and precision

**Scale Definition:** [Source: frontend-spec-new.md#1.2]
```css
h1: 2.5rem / 600
h2: 2rem / 600
h3: 1.5rem / 600
h4: 1.25rem / 600
body: 1rem / 400
small: 0.875rem / 400
```

### Current Tailwind Configuration Analysis
**Existing Setup:** [Source: tailwind.config.ts analysis]
- ✅ **shadcn/ui integration:** CSS custom properties with hsl() values
- ❌ **PolicyAi colors:** Safelist contains notebook-related colors to remove
- ✅ **Base structure:** Container, border radius, animations configured
- ❌ **Previa colors:** Not yet implemented in theme extension

**Required Updates:**
- Remove PolicyAi notebook color safelist
- Add Previa color palette to theme.extend.colors
- Configure typography font families
- Update CSS custom properties for Previa colors

### shadcn/ui Component Customization
**Key Components for Financial UI:** [Source: frontend-spec-new.md#3]
- **Button:** Primary actions, CTAs (cream default, sand hover)
- **Card:** Financial widgets, transaction cards (cream background)
- **Input:** Forms, search (sand focus ring, charcoal text)
- **Table:** Transaction lists (zebra striping, right-aligned amounts)
- **Badge:** Status indicators (color-coded for transaction states)
- **Progress:** Upload progress, confidence indicators (sand fill)

### Financial-Specific Styling Requirements
**Transaction Display:** [Source: frontend-spec-new.md#2.5]
- Right-aligned amounts in JetBrains Mono
- Color-coded status badges
- Zebra striping for readability
- Hover states for interactive rows

**Reconciliation Confidence:** [Source: frontend-spec-new.md#2.4]
- Progress circles for confidence scores
- Color coding: Green (high), Yellow (medium), Red (low)
- Visual indicators for auto-approval thresholds

**File Upload States:** [Source: frontend-spec-new.md#2.7]
- Upload progress with sand fill color
- Status indicators: uploading, processing, completed, failed
- Drag/drop zone styling with dashed sand border

### Accessibility Requirements
**Color Contrast Validation:** [Source: frontend-spec-new.md#5]
- Charcoal on Cream: 7.2:1 ✅ (exceeds AA standard)
- DarkStone on Cream: 5.1:1 ✅ (meets AA standard)
- Stone on Cream: 3.2:1 ⚠️ (use for secondary text only)

**Keyboard Navigation:** [Source: frontend-spec-new.md#5]
- Visible focus indicators (sand color, 2px outline)
- Logical tab order
- All interactive elements accessible

**Screen Reader Support:**
- Semantic HTML structure
- Proper ARIA labels
- Status announcements for dynamic content

### CSS Custom Properties Structure
**Color Variables:** [Source: shadcn/ui pattern]
```css
:root {
  --background: 28 25 20;           /* cream */
  --foreground: 18 16 12;           /* charcoal */
  --primary: 39 35 27;              /* darkStone */
  --primary-foreground: 28 25 20;   /* cream */
  --secondary: 51 46 36;            /* stone */
  --accent: 50 44 32;               /* sand */
  /* Financial status colors */
  --success: 16 185 129;            /* green */
  --warning: 245 158 11;            /* amber */
  --error: 239 68 68;               /* red */
  --processing: 59 130 246;         /* blue */
}
```

### Typography Integration
**Font Loading:**
- Import Inter from Google Fonts
- Import JetBrains Mono for financial numbers
- Configure font-display: swap for performance

**Usage Patterns:**
- Headings: font-family: Inter, weight: 600
- Body text: font-family: Inter, weight: 400
- Financial amounts: font-family: JetBrains Mono, weight: 500

### Component Documentation Requirements
**Style Guide Sections:**
- Color palette with usage examples
- Typography hierarchy with samples
- Component states (default, hover, active, disabled)
- Financial data formatting examples
- Accessibility features

### Technical Constraints
- **shadcn/ui compatibility:** Must work with existing component structure [Source: TECHNICAL-DECISIONS.md#9]
- **Performance:** Minimize CSS bundle size [Source: architecture/1-goals-scope-constraints.md]
- **Browser support:** Modern browsers with CSS custom properties [Source: architecture/1-goals-scope-constraints.md]
- **Maintainability:** Design tokens as single source of truth [Source: TECHNICAL-DECISIONS.md#9]

### Testing Requirements
**Visual Testing:**
- Component rendering with Previa colors
- Typography rendering across font weights
- Contrast ratio validation
- Responsive behavior verification

**Accessibility Testing:**
- Screen reader compatibility
- Keyboard navigation flow
- Focus indicator visibility
- Color-only information accessibility

Test file location: `src/test/design-system/` directory
Testing frameworks: Vitest + accessibility testing tools
Specific testing requirements: Contrast validation, component rendering, accessibility compliance

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-09 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent review will be added here*